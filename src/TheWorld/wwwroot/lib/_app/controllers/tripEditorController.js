!function(){"use strict";function t(t,s){var e,i=this;i.tripName=t.tripName,i.stops=[],i.errorMessage="",i.isBusy=!0,i.newStop={},e="/api/trips/"+i.tripName+"/stops",s.get(e).then(function(t){angular.copy(t.data,i.stops),n(i.stops)},function(t){i.errorMessage="Failed to load stops: "+t}).finally(function(){i.isBusy=!1}),i.addStop=function(){i.isBusy=!0,s.post(e,i.newStop).then(function(t){i.stops.push(t.data),n(i.stops),i.newStop={}},function(t){i.errorMessage="Failed to save new stop :"+t}).finally(function(){i.isBusy=!1})},i.removeStop=function(t){i.isBusy=!0,s.delete("/api/trips/"+i.tripName+"/"+t.name).then(function(s){i.stops=o(i.stops,t.name),n(i.stops)},function(){}).finally(function(){i.isBusy=!1})}}function n(t){if(t&&t.length>0){var n=_.map(t,function(t){return{lat:t.latitude,long:t.longitude,info:t.name}});travelMap.createMap({stops:n,selector:"#map",currentStop:1,initialZoom:4})}}function o(t,n){var o=[];return t.forEach(function(t){t.name!==n&&o.push(t)}),o}t.$inject=["$routeParams","$http"],angular.module("app-trips").controller("tripEditorController",t)}();